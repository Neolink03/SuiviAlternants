{% extends '::base.html.twig' %}

{% block title %}Détails formation - {{ course.name }}{% endblock %}

{% block body %}
    <h1>{{ course.name }}</h1>
    <p>{{ course.studentNumber }} places maximum</p>
    {{ promotion.name }}
    <hr>

    <div class="row col-12">
        {{ form_start(promotionsForm, {
            'attr': { 'class': 'form-inline' },
            'action': path('course_manager.course', { 'courseId': course.id, 'promotion': promotionsForm.promotions.vars.value })
        }) }}
        <div class="form-group">
            {{ form_label(promotionsForm.promotions, null, { 'label_attr': { 'class': 'mr-sm-2' } }) }}
            {{ form_widget(promotionsForm.promotions, { 'attr': { 'class': 'form-control mb-2 mr-sm-2 mb-sm-0' } }) }}
        </div>
        <div class="form-group">
            {{ form_widget(promotionsForm.submit, {'attr': {'class': 'btn btn-primary'}}) }}
        </div>
        {{ form_rest(promotionsForm) }}
        {{ form_end(promotionsForm) }}
    </div>

    <table class="table table-striped table-bordered">
        <th>#</th>
        <th>Nom</th>
        <th>Prénom</th>
        <th>Statut</th>

        {% for application in promotion.applications %}
            <tr>
                <th>{{ loop.index }}</td>
                <td>{{ application.student.firstName }}</td>
                <td>{{ application.student.lastName }}</td>
                <td>
                    {% if application.getLastStatusModification() %}
                        <a href="{{ path('course_manager.application.view', {'applicationId': application.id }) }}"> {{ application.getLastStatusModification().state.name }}</a>
                    {% else %}
                        <a href="{{ path('course_manager.application.view', {'applicationId': application.id }) }}">Application with no status</a>
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
    </table>

{% endblock %}